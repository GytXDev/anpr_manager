<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">
  <t t-name="anpr_peage_manager" owl="1">
    <div class="o_container o_form_view bg-light p-4"
      style="max-width:600px; height:90vh; overflow-y:auto; margin:auto; border-radius:12px; box-shadow:0 0 15px rgba(0,0,0,0.1);">
      <h2 class="text-center mb-4">üõ£Ô∏è Poste de P√©age</h2>

      <!-- Type de v√©hicule -->
      <div class="mb-3">
        <label class="form-label fw-bold">Type de v√©hicule</label>
        <select class="form-select"
                t-att-value="state.vehicle_type"
                t-on-change="onVehicleTypeChange">
          <t t-foreach="['', 'voiture', 'bus', 'taxi', 'moto', 'camion']" t-as="type" t-key="type">
            <option t-att-value="type">
              <t t-esc="type ? type.charAt(0).toUpperCase() + type.slice(1) : '-- Choisir --'" />
            </option>
          </t>
        </select>
      </div>

      <!-- Plaque -->
      <div class="mb-3">
        <label class="form-label fw-bold">Plaque d'immatriculation</label>
        <input type="text" class="form-control" placeholder="Ex: TR-123-AB" t-model="state.plate"/>
      </div>

      <!-- Num√©ro Mobile Money -->
      <div class="mb-3">
        <label class="form-label fw-bold">Num√©ro Airtel Money</label>
        <input type="tel" class="form-control" placeholder="Ex: 074001209" t-model="state.numero"/>
      </div>

      <!-- Montant automatique (readonly) -->
      <div class="mb-3">
        <label class="form-label fw-bold">Montant √† payer (CFA)</label>
        <input type="hidden" t-model="state.amount"/>
        <input type="number" class="form-control" t-model="state.amount" readonly="readonly"/>
        <div class="form-text text-muted">Tarif appliqu√© automatiquement selon le type de v√©hicule</div>
      </div>

      <!-- Bouton paiement -->
      <div class="d-grid gap-2 mt-4">
        <button class="btn btn-primary fw-bold" t-on-click="onPayClick" t-att-disabled="state.loading">
          <t t-if="!state.loading">üí≥ Payer</t>
          <t t-if="state.loading">‚è≥ Paiement en cours...</t>
        </button>
      </div>

      <!-- R√©sultat -->
      <div class="mt-4 text-center" t-if="state.result_message">
        <t t-if="state.payment_status === 'success'">
          <div class="alert alert-success">‚úÖ <t t-esc="state.result_message"/></div>
          <h3 class="text-success fw-bold">üü¢ Vous pouvez passer</h3>
        </t>
        <t t-elif="state.payment_status === 'failed'">
          <div class="alert alert-danger">‚ùå <t t-esc="state.result_message"/></div>
        </t>
        <t t-else="">
          <div class="alert alert-warning">‚ö†Ô∏è <t t-esc="state.result_message"/></div>
        </t>
      </div>
    </div>
  </t>
</templates>